# Phase 4: 活動量解析モジュール 処理説明書

**フェーズ名**: Phase 4 - 活動量解析  
**作成日**: 2025-07-29  
**作成者**: 開発チーム  

---

## 📋 概要

Phase 4では昆虫の活動量解析に関する3つの主要モジュールを実装しています。検出された昆虫の位置データから活動量を算出し、統計的分析を行い、視覚的な表現を生成します。

---

## 📁 含まれるモジュール

### 1. activity_calculator.py
- **役割**: 昆虫の活動量・移動パターンの算出
- **主要機能**: 移動距離計算、統計指標算出、時間パターン分析
- **処理説明書**: `activity_calculator_processing_spec.md`

### 2. data_processor.py  
- **役割**: 時系列検出データの分析・変換・集約処理
- **主要機能**: データクリーニング、異常値処理、正規化、特徴量抽出
- **処理説明書**: `data_processor_processing_spec.md`

### 3. visualization.py
- **役割**: 昆虫活動データの可視化・グラフ・チャート生成
- **主要機能**: タイムライン作成、ヒートマップ、ダッシュボード、レポート生成
- **処理説明書**: `visualization_processing_spec.md`

---

## 🔄 データフロー

```
検出データ (CSVファイル)
   ↓
data_processor.py (前処理・クリーニング)
   ↓
activity_calculator.py (活動量算出)
   ↓
visualization.py (可視化・レポート生成)
   ↓
可視化ファイル (PNG/HTML/PDF)
```

---

## 📊 処理対象データ

### 入力データ
- 時系列検出データ（CSV形式）
- 座標情報（x_center, y_center）
- 検出信頼度・タイムスタンプ

### 出力データ
- 活動量指標（ActivityMetrics）
- 時間別サマリー（HourlyActivitySummary）
- 可視化ファイル（グラフ・チャート・ダッシュボード）

---

## 🔧 主要アルゴリズム

### 移動距離計算
- ユークリッド距離による移動量算出
- 異常な移動速度の検出・除去
- 移動平均による平滑化

### 異常値処理
- Z-score法による統計的異常値検出
- IQR（四分位範囲）による外れ値検出
- Isolation Forest機械学習手法

### データ可視化
- matplotlib静的グラフ生成
- plotlyインタラクティブダッシュボード
- 時系列チャート・ヒートマップ・統計図

---

## 📝 実装状況

| モジュール | 実装状況 | 処理説明書 | テスト |
|-----------|---------|-----------|-------|
| activity_calculator.py | ✅ 完了 | ✅ 作成済み | ✅ 単体テスト付き |
| data_processor.py | ✅ 完了 | ✅ 作成済み | ✅ 単体テスト付き |
| visualization.py | ✅ 完了 | ✅ 作成済み | ✅ 単体テスト付き |

---

## 🔄 更新履歴

| 日付 | 内容 | 更新者 |
|------|------|--------|
| 2025-07-29 | Phase 4処理説明書作成完了 | 開発チーム |
| 2025-07-28 | Phase 4モジュール実装完了 | 開発チーム |